<!doctype html><html lang=zh-CN><head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><meta charset=UTF-8><meta name=generator content="Hugo 0.122.0"><meta name=theme-color content="#16171d"><meta name=color-scheme content="light dark"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no, date=no, address=no, email=no"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><title>Gentoo安装记录 | Ticks的博客</title>
<link rel=stylesheet href=/css/meme.min.dba91f7e262d8059594b4738a28c5fd3028294f757a939226b34e4e5eab4867e.css><script src=/js/meme.min.e46abe484398824efc70edec3126437916974df592d7c395b44f8f60e0f57e9d.js></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href=https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/style.css media=print onload='this.media="all"'><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&amp;family=Roboto+Mono:wght@400;500;700&amp;family=Source+Code+Pro:wght@400;500;700&amp;family=Tilt+Neon&amp;display=swap" media=print onload='this.media="all"'><noscript><link rel=stylesheet href=#ZgotmplZ></noscript><meta name=author content="Ticks"><meta name=description content="最近打算将手上的 AMD Linux 切换到 Gentoo，写一篇文章记录下安装过程。 本文可能不适用于L……"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=mask-icon href=/icons/safari-pinned-tab.svg color=#2a6df4><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="Ticks的博客"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=mobile-web-app-capable content="yes"><meta name=application-name content="Ticks的博客"><meta name=msapplication-starturl content="../../../"><meta name=msapplication-TileColor content="#fff"><meta name=msapplication-TileImage content="../../../icons/mstile-150x150.png"><link rel=manifest href=/manifest.json><link rel=canonical href=https://blog.ticks.cc/posts/id/09061821/><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","datePublished":"2023-09-06T00:00:00+00:00","dateModified":"2024-02-06T05:46:33+00:00","url":"https://blog.ticks.cc/posts/id/09061821/","headline":"Gentoo安装记录","description":"最近打算将手上的 AMD Linux 切换到 Gentoo，写一篇文章记录下安装过程。 本文可能不适用于L……","inLanguage":"zh-CN","articleSection":"posts","wordCount":4601,"image":"https://blog.ticks.cc/icons/apple-touch-icon.png","author":{"@type":"Person","description":"Nothing can do ಥ_ಥ","email":"ticks.cc@gmail.com","image":"https://blog.ticks.cc/icons/apple-touch-icon.png","url":"https://blog.ticks.cc","name":"Ticks"},"license":"[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)","publisher":{"@type":"Organization","name":"Ticks的博客","logo":{"@type":"ImageObject","url":"https://blog.ticks.cc/icons/apple-touch-icon.png"},"url":"https://blog.ticks.cc/"},"mainEntityOfPage":{"@type":"WebSite","@id":"https://blog.ticks.cc/"}}</script><meta name=twitter:card content="summary"><meta name=twitter:site content="@ticks07"><meta name=twitter:creator content="@ticks007"><meta property="og:title" content="Gentoo安装记录"><meta property="og:description" content="最近打算将手上的 AMD Linux 切换到 Gentoo，写一篇文章记录下安装过程。 本文可能不适用于L……"><meta property="og:url" content="https://blog.ticks.cc/posts/id/09061821/"><meta property="og:site_name" content="Ticks的博客"><meta property="og:locale" content="zh"><meta property="og:image" content="https://blog.ticks.cc/icons/apple-touch-icon.png"><meta property="og:type" content="article"><meta property="article:published_time" content="2023-09-06T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-06T05:46:33+00:00"><meta property="article:section" content="posts"></head><body><div class=container><header class=header><div class=header-wrapper><div class="header-inner single"><div class=site-brand><a href=/ class=brand>Ticks的博客</a></div><nav class=nav><ul class=menu id=menu><li class="menu-item active"><a href=/posts/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon archive"><path d="M32 448c0 17.7 14.3 32 32 32h384c17.7.0 32-14.3 32-32V160H32v288zm160-212c0-6.6 5.4-12 12-12h104c6.6.0 12 5.4 12 12v8c0 6.6-5.4 12-12 12H204c-6.6.0-12-5.4-12-12v-8zM480 32H32C14.3 32 0 46.3.0 64v48c0 8.8 7.2 16 16 16h480c8.8.0 16-7.2 16-16V64c0-17.7-14.3-32-32-32z"/></svg><span class=menu-item-name>文章</span></a></li><li class=menu-item><a href=/tags/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="icon tags"><path d="M497.941 225.941 286.059 14.059A48 48 0 00252.118.0H48C21.49.0.0 21.49.0 48v204.118a48 48 0 0014.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882.0l204.118-204.118c18.745-18.745 18.745-49.137.0-67.882zM112 160c-26.51.0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882.0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397.0h48.721a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882z"/></svg><span class=menu-item-name>标签</span></a></li><li class=menu-item><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon user-circle"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6.0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7.0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4.0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9s28-2.7 40.9-6.9c2.3-.7 4.7-1.1 7.1-1.1 42.9.0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"/></svg><span class=menu-item-name>关于</span></a></li><li class=menu-item><a href=/nav/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon link"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg><span class=menu-item-name>导航</span></a></li><li class=menu-item><a id=theme-switcher href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-light"><path d="M193.2 104.5 242 7a18 18 0 0128 0l48.8 97.5L422.2 70A18 18 0 01442 89.8l-34.5 103.4L505 242a18 18 0 010 28l-97.5 48.8L442 422.2A18 18 0 01422.2 442l-103.4-34.5L270 505a18 18 0 01-28 0l-48.8-97.5L89.8 442A18 18 0 0170 422.2l34.5-103.4-97.5-48.8a18 18 0 010-28l97.5-48.8L70 89.8A18 18 0 0189.8 70zM256 128a128 128 0 10.01.0M256 160a96 96 0 10.01.0"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon theme-icon-dark"><path d="M27 412A256 256 0 10181 5a11.5 11.5.0 00-5 20A201.5 201.5.0 0142 399a11.5 11.5.0 00-15 13"/></svg></a></li></ul></nav></div></div><input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label>
<label for=nav-toggle class=nav-curtain></label></header><main class="main single" id=main><div class=main-inner><article class="content post h-entry" data-align=justify data-type=posts data-toc-num=true><h1 class="post-title p-name">Gentoo安装记录</h1><div class=post-meta><time datetime=2023-09-06T00:00:00+00:00 class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;2023-9-6</time>
<time datetime=2024-02-06T05:46:33+00:00 class="post-meta-item modified dt-updated"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M4e2 64h-48V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H160V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H48C21.49 64 0 85.49.0 112v352c0 26.51 21.49 48 48 48h352c26.51.0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 4e2H54a6 6 0 01-6-6V160h352v298a6 6 0 01-6 6zm-52.849-200.65L198.842 404.519c-4.705 4.667-12.303 4.637-16.971-.068l-75.091-75.699c-4.667-4.705-4.637-12.303.068-16.971l22.719-22.536c4.705-4.667 12.303-4.637 16.97.069l44.104 44.461 111.072-110.181c4.705-4.667 12.303-4.637 16.971.068l22.536 22.718c4.667 4.705 4.636 12.303-.069 16.97z"/></svg>&nbsp;2024-2-6</time>
<span class="post-meta-item category"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49.0 112v288c0 26.51 21.49 48 48 48h416c26.51.0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>&nbsp;<a href=/posts/ class="category-link p-category">Posts</a></span>
<span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;4601</span></div><nav class=contents><h2 id=contents class=contents-title>目录</h2><ol class=toc><li><a id=contents:关于gentoo href=#关于gentoo>关于Gentoo</a></li><li><a id=contents:准备安装介质 href=#准备安装介质>准备安装介质</a></li><li><a id=contents:网络配置 href=#网络配置>网络配置</a></li><li><a id=contents:准备磁盘 href=#准备磁盘>准备磁盘</a></li><li><a id=contents:安装gentoo安装文件 href=#安装gentoo安装文件>安装Gentoo安装文件</a></li><li><a id=contents:配置编译选项和镜像 href=#配置编译选项和镜像>配置编译选项和镜像</a></li><li><a id=contents:进入gentoo环境 href=#进入gentoo环境>进入Gentoo环境</a></li><li><a id=contents:配置-portage-并更新系统 href=#配置-portage-并更新系统>配置 Portage 并更新系统</a></li><li><a id=contents:配置时区与区域 href=#配置时区与区域>配置时区与区域</a></li><li><a id=contents:配置文件系统 href=#配置文件系统>配置文件系统</a></li><li><a id=contents:其他配置 href=#其他配置>其他配置</a><ol><li><a id=contents:修改主机名 href=#修改主机名>修改主机名：</a></li><li><a id=contents:配置网络 href=#配置网络>配置网络：</a></li><li><a id=contents:安装内核 href=#安装内核>安装内核</a></li><li><a id=contents:安装必要的软件 href=#安装必要的软件>安装必要的软件</a></li><li><a id=contents:配置引导 href=#配置引导>配置引导：</a></li><li><a id=contents:添加用户 href=#添加用户>添加用户</a></li></ol></li><li><a id=contents:收尾工作 href=#收尾工作>收尾工作</a></li><li><a id=contents:最后 href=#最后>最后</a></li></ol></nav><div class="post-body e-content"><p>最近打算将手上的 <strong>AMD Linux</strong> 切换到 Gentoo，写一篇文章记录下安装过程。</p><div class="notice notice-warning"><div class=notice-title><svg xmlns="http://www.w3.org/2000/svg" class="icon notice-icon" viewBox="0 0 576 512"><path d="M570 440c18 32-5 72-42 72H48c-37 0-60-40-42-72L246 24c19-32 65-32 84 0l240 416zm-282-86a46 46 0 100 92 46 46 0 000-92zm-44-165 8 136c0 6 5 11 12 11h48c7 0 12-5 12-11l8-136c0-7-5-13-12-13h-64c-7 0-12 6-12 13z"/></svg></div><ul><li><p>本文可能不适用于Linux新手，无论你是Linux安装老手还是对于无UI的Linux安装过程不太了解，都建议你在有任何疑惑时优先查看Gentoo官方Wiki，<strong>本文仅作为安装参考</strong>，而且安装过程中一些概念我也没有进行详细解释。
当然，我会在每个小结最后贴上部分参考链接，方便查阅。</p></li><li><p>Gentoo 安装过程很长，请准备充足的时间再尝试安装，否则中断后再进行比较麻烦！</p></li></ul></div><h2 id=关于gentoo><a href=#关于gentoo class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:关于gentoo class=headings>关于Gentoo</a></h2><p>Gentoo也是一个历史比较悠久的Linux发行版，特点是系统安装最小化，允许用户自行选择各种软件包完成系统组装，软件安装采用源码编译，针对每个设备进行过优化，软件运行效率可能更高。软件包更新没有ArchLinux激进，但又不至于像Debian那样总是使用稳定的软件版本。</p><p>参考：</p><ul><li><a href=https://www.gentoo.org/ target=_blank rel=noopener>Gentoo 官网</a></li><li><a href=https://wiki.gentoo.org/wiki/Main_Page target=_blank rel=noopener>Gentoo Wiki</a></li><li><a href=https://baike.baidu.com/item/Gentoo/1205576 target=_blank rel=noopener>Gentoo 百度百科</a></li></ul><h2 id=准备安装介质><a href=#准备安装介质 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:准备安装介质 class=headings>准备安装介质</a></h2><p>Gentoo安装不同于Ubuntu、Arch那样使用自己的安装介质，Gentoo允许你使用其他Linux安装介质，因为Gentoo安装只需要借助安装介质中的各种工具，比如磁盘格式化、连接网络下载文件等。由于我从Arch换到Gentoo，所以我这里直接使用了Arch的安装介质，比较方便而且Arch安装介质中的 <code>fstab</code> 工具也蛮好用的。</p><p>当然Gentoo也提供了官方的安装介质，篇幅原因这里不介绍如何烧录Linux安装介质到U盘中，Windows用户可以使用 <a href=https://rufus.ie/zh/ target=_blank rel=noopener>rufus</a> ，ArchLinux ISO 下载地址：<a href=https://mirrors.tuna.tsinghua.edu.cn/archlinux/iso/latest/ target=_blank rel=noopener>清华镜像站-ArchLinux</a> 。</p><p>参考</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Media/zh-cn target=_blank rel=noopener>Gentoo Wiki - 选择正确的安装介质</a></li><li><a href=https://zhuanlan.zhihu.com/p/370193387 target=_blank rel=noopener>知乎 - Rufus制作USB启动盘</a></li></ul><h2 id=网络配置><a href=#网络配置 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:网络配置 class=headings>网络配置</a></h2><p>烧录好安装介质后可以插上U盘并启动到 LiveCD 系统了，安装介质中提供了基础的Linux运行环境，首先要做的就是配置好网络与时间，方便之后下载文件和软件包。</p><p>ArchLinux安装介质中包含了 <code>iwd</code> 软件包，可以帮助我们连接到Wifi：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rfkill unblock all <span class=c1># 可以启用被内核禁用的设备</span>
</span></span><span class=line><span class=cl>iwctl <span class=c1># 回车后进入iwd操作界面</span>
</span></span><span class=line><span class=cl>---------- iwd 界面 ----------
</span></span><span class=line><span class=cl><span class=o>[</span>iwd<span class=o>]</span> <span class=nb>help</span> <span class=c1># 可以查看iwd相关命令</span>
</span></span><span class=line><span class=cl><span class=o>[</span>iwd<span class=o>]</span> device list <span class=c1># 可以查看当前网卡设备，wifi一般为 wlan0 wlan1等</span>
</span></span><span class=line><span class=cl><span class=o>[</span>iwd<span class=o>]</span> station &lt;device&gt; scan <span class=c1># 使用&lt;device&gt;网卡扫描可用的网络</span>
</span></span><span class=line><span class=cl><span class=o>[</span>iwd<span class=o>]</span> station &lt;device&gt; get-networks <span class=c1># 显示当前扫描到的网络</span>
</span></span><span class=line><span class=cl><span class=o>[</span>iwd<span class=o>]</span> station &lt;device&gt; connect &lt;wifi name&gt; <span class=c1># 连接wifi，如果有密码会提示输入密码</span>
</span></span><span class=line><span class=cl><span class=o>[</span>iwd<span class=o>]</span> quit // 退出iwd操作界面
</span></span><span class=line><span class=cl>-----------------------------
</span></span></code></pre></td></tr></table></div></div></div><p>配置好网络后需要确保当前系统时间是否正常，输入 <code>date</code> 查看当前日期，如果相差太远，需要先进行时间同步，否则无法下载网络文件。一般情况下电脑主板都会记录时间，不会相差太多。</p><p>Gentoo官方介质中提供了 <code>chronyd</code> 软件，可以使用 <code>chronyd -q</code> 进行同步，当然也可以手动进行设置，使用 <code>date</code> 命令来对系统时钟执行手动设置。它使用以下格式作为参数：使用 MMDDhhmmYYYY 语法（Month（月），Day（天），hour（小时），minute（分钟） 和 Year（年））。比如设置时间到 <strong>2023年9月16日20:30</strong> ：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>date <span class=m>091620302023</span>
</span></span></code></pre></td></tr></table></div></div></div><p>参考：</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Networking/zh-cn target=_blank rel=noopener>Gentoo Wiki - 配置网络</a></li><li><a href=https://wiki.archlinuxcn.org/wiki/%E5%AE%89%E8%A3%85%E6%8C%87%E5%8D%97#%E8%BF%9E%E6%8E%A5%E5%88%B0%E4%BA%92%E8%81%94%E7%BD%91 target=_blank rel=noopener>Arch Installation - 连接到互联网</a></li></ul><h2 id=准备磁盘><a href=#准备磁盘 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:准备磁盘 class=headings>准备磁盘</a></h2><p>跟其他Linux发行版安装一样，在安装前进行磁盘分区与格式化。</p><p>我习惯将 <strong>home</strong> 分区单独分区，所以我需要准备四个分区，分区大小按照我的情况推荐，具体根据自身情况分配：</p><div class=table-container><table><thead><tr><th>设备位置(ssd可能为/dev/nvme0n1)</th><th>挂载位置</th><th>文件系统格式</th><th>推荐大小</th><th>说明</th></tr></thead><tbody><tr><td>/dev/sda1</td><td>/boot</td><td>vfat</td><td>>=500M</td><td>挂载引导分区，如果双系统安装该分区应该已经存在</td></tr><tr><td>/dev/sda2</td><td>/home</td><td>ext4/btrfs/...</td><td>>= 100G</td><td>用户目录，平时使用用户软件数据存放位置，稍微大一点</td></tr><tr><td>/dev/sda3</td><td>/</td><td>ext4/btrfs/...</td><td>>= 60G</td><td>系统其他目录，包括系统软件、可执行文件、日志等，稍微大一点</td></tr><tr><td>/dev/sda4</td><td></td><td>swap</td><td>系统内存/2左右</td><td>交换空间，有休眠需求或者大型软件使用</td></tr></tbody></table></div><p>使用 <code>cfdisk</code> 进行分区划分，有UI操作界面，比 <code>fdisk</code> 更直观，之后进行格式化：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 格式化 boot 分区，双系统如果已经存在，可以逃过格式化boot分区，之后直接挂载</span>
</span></span><span class=line><span class=cl>mkfs.vfat -F <span class=m>32</span> /dev/sda1
</span></span><span class=line><span class=cl><span class=c1># 格式化 home 与根分区</span>
</span></span><span class=line><span class=cl>mkfs.ext4 /dev/sda2
</span></span><span class=line><span class=cl>mkfs.ext4 /dev/sda3
</span></span><span class=line><span class=cl><span class=c1># 格式化swap</span>
</span></span><span class=line><span class=cl>mkswap /dev/sda4
</span></span><span class=line><span class=cl><span class=c1># 激活swap</span>
</span></span><span class=line><span class=cl>swapon /dev/sda4
</span></span></code></pre></td></tr></table></div></div></div><p>创建根目录：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir -pv /mnt/gentoo
</span></span></code></pre></td></tr></table></div></div></div><p>挂载根目录</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mount -v /dev/sda3 /mnt/gentoo
</span></span></code></pre></td></tr></table></div></div></div><p>参考：</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Disks/zh-cn target=_blank rel=noopener>Gentoo Wiki - 准备磁盘</a></li></ul><h2 id=安装gentoo安装文件><a href=#安装gentoo安装文件 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:安装gentoo安装文件 class=headings>安装Gentoo安装文件</a></h2><p>Gentoo提供了几种不同的安装文件，主要分为 <strong>multilib(32+64位)</strong> 、<strong>no-multilib(64位)</strong> 、<strong>systemd</strong> 、<strong>openrc</strong> 几种组合，如果没有systemd需求则使用openrc版本，对于 <strong>no-multilib</strong> ，一般人不要选择。</p><p>不同版本会影响之后系统配置，由于是源码安装，安装好后再切换配置会变得非常麻烦，请考虑清楚后再决定！！！</p><p>下载地址：</p><ul><li><a href=https://www.gentoo.org/downloads/ target=_blank rel=noopener>Gentoo官方</a></li><li><a href=https://mirrors.tuna.tsinghua.edu.cn/gentoo/releases/amd64/autobuilds/ target=_blank rel=noopener>TUNA镜像</a></li><li><a href=https://mirrors.ustc.edu.cn/gentoo/releases/amd64/autobuilds/ target=_blank rel=noopener>USTC镜像</a></li><li><a href=https://mirrors.aliyun.com/gentoo/releases/amd64/autobuilds/ target=_blank rel=noopener>Aliyun镜像</a></li></ul><p>使用 <strong>curl</strong>、<strong>wget</strong>等工具下载需要的版本到 <code>/mnt/gentoo</code> 目录下，之后进行解压：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 进入目录</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> /mnt/gentoo
</span></span><span class=line><span class=cl><span class=c1># 解压缩，包含一个基本的Linux文件系统</span>
</span></span><span class=line><span class=cl>tar xpvf stage3-*.tar.xz --xattrs-include<span class=o>=</span><span class=s1>&#39;*.*&#39;</span> --numeric-owner
</span></span></code></pre></td></tr></table></div></div></div><p>参考：</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Stage/zh-cn#.E5.AE.89.E8.A3.85stage.E5.8C.85 target=_blank rel=noopener>Gentoo Wiki</a></li></ul><h2 id=配置编译选项和镜像><a href=#配置编译选项和镜像 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:配置编译选项和镜像 class=headings>配置编译选项和镜像</a></h2><blockquote><p>本节内容非常重要，涉及到了Gentoo中优化和配置系统的主要内容以及包管理器相关知识，建议认真阅读参考链接！！！</p></blockquote><p>Gentoo支持包管理器，并支持一些系统变量，编译软件时会从特定文件读取这些系统变量，可以通过配置环境变量达到调整系统的作用。配置编译选项的文件位于系统 <code>/etc/portage/make.conf</code> ，当前位于 <code>/mnt/gentoo/etc/portage/make.conf</code> ，下面是一些变量的说明：</p><ul><li><strong>CFLAGS</strong> ：定义GCC编译优化标志，一般修改为 <code>CFLAGS="-march=native -O2 -pipe"</code> 即可，-march指定cpu架构，不清楚填 <code>native</code> 即可，可在 <a href=https://www.funtoo.org/Subarches target=_blank rel=noopener>此处</a> 查看，配合设置 <code>CHOST</code> 变量。</li><li><strong>CXXFLAGS</strong> ：C++编译优化标志，同上即可。</li><li><strong>MAKEOPTS</strong> ：指定编译时使用线程数量，越大越快，内存消耗越大，根据cpu核心数设置，不要太大，比如8核心16线程可以设置为 <code>MAKEOPTS="-j6"</code> 。</li><li><strong>GENTOO_MIRRORS</strong> ：指定Gentoo软件包镜像，比如 USTC镜像 ：<code>GENTOO_MIRRORS="https://mirrors.ustc.edu.cn/gentoo/"</code> ，根据具体镜像站设置。</li><li><strong>USE</strong> ：控制系统软件包使用哪些和不使用哪些功能，参考wiki。</li><li><strong>EMERGE_DEFAULT_OPTS</strong> ：emerge 默认选项，具体参考 Gentoo Emerge。</li><li><strong>ACCEPT_KEYWORDS</strong> ：允许的软件包架构，如果需要使用测试版软件，务必加上 <code>ACCEPT_KEYWORDS="~amd64"</code> 。</li><li><strong>ACCEPT_LICENSE</strong> ：允许的软件许可协议，直接设置为允许全部即可：<code>ACCEPT_LICENSE="*"</code>。</li><li><strong>L10N</strong> ：系统语言，一般允许中、英文即可：<code>L10N="en-US zh-CN en zh"</code> 。</li><li><strong>CPU_FLAGS_X86</strong> ：针对特定cpu的编译选项，系统安装好之后安装 <code>app-portage/cpuid2cpuflags</code> 软件，使用 <code>cpuid2cpuflags</code> 获取，然后写入该变量中。</li><li><strong>VIDEO_CARDS</strong> ：根据显卡设置。</li><li>其他 ：参考 <a href=https://wiki.gentoo.org/wiki//etc/portage/make.conf/zh-cn target=_blank rel=noopener>Gentoo Wiki - make.conf</a> 。</li></ul><p>还需要配置 portage 镜像，官方的日常使用太慢，配置文件位于：<code>/etc/portage/repos.conf/gentoo.conf</code>，LiveCD为：<code>/mnt/gentoo//etc/portage/repos.conf/gentoo.conf</code>，没有可以新建：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=p>[</span><span class=nx>DEFAULT</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>main-repo</span> <span class=p>=</span> <span class=nx>gentoo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>gentoo</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>location</span> <span class=p>=</span> <span class=err>/</span><span class=nx>var</span><span class=err>/</span><span class=nx>portage</span>
</span></span><span class=line><span class=cl><span class=nx>sync-type</span> <span class=p>=</span> <span class=nx>rsync</span>
</span></span><span class=line><span class=cl><span class=c># TUNA镜像站</span>
</span></span><span class=line><span class=cl><span class=nx>sync-uri</span> <span class=p>=</span> <span class=nx>rsync</span><span class=err>://</span><span class=nx>mirrors</span><span class=p>.</span><span class=nx>tuna</span><span class=p>.</span><span class=nx>tsinghua</span><span class=p>.</span><span class=nx>edu</span><span class=p>.</span><span class=nx>cn</span><span class=err>/</span><span class=nx>gentoo-portage</span><span class=err>/</span>
</span></span><span class=line><span class=cl><span class=nx>auto-sync</span> <span class=p>=</span> <span class=nx>yes</span>
</span></span></code></pre></td></tr></table></div></div></div><p>参考链接：</p><ul><li><a href=https://wiki.gentoo.org/wiki//etc/portage/make.conf/zh-cn target=_blank rel=noopener>Gentoo Wiki - make.conf</a></li><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Stage/zh-cn#.E9.85.8D.E7.BD.AE.E7.BC.96.E8.AF.91.E9.80.89.E9.A1.B9 target=_blank rel=noopener>Gentoo Wiki - 配置编译选项</a></li><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Working/USE/zh-cn target=_blank rel=noopener>Gentoo Wiki - 使用USE标记</a></li><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Working/Portage/zh-cn target=_blank rel=noopener>Gentoo Wiki - Portage介绍</a></li><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Working/EnvVar/zh-cn target=_blank rel=noopener>Gentoo Wiki - 环境变量</a></li></ul><p>下面是一个 <code>make.conf</code> 文件例子，<strong>仅供参考</strong>：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>########### Build Flags ##########</span>
</span></span><span class=line><span class=cl><span class=nv>BUILD_FLAGS</span><span class=o>=</span><span class=s2>&#34;-march=native -O2 -pipe&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>CFLAGS</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>BUILD_FLAGS</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>CXXFLAGS</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>BUILD_FLAGS</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>CHOST</span><span class=o>=</span><span class=s2>&#34;x86_64-pc-linux-gnu&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>MAKEOPTS</span><span class=o>=</span><span class=s2>&#34;-j6&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 使用 cpuid2cpuflags命令后写入其中</span>
</span></span><span class=line><span class=cl><span class=c1># CPU_FLAGS_X86=&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>########## USE Flags ##########</span>
</span></span><span class=line><span class=cl><span class=nv>USE_YES</span><span class=o>=</span><span class=s2>&#34;git pulseaudio ext4 cjk&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>USE_NO</span><span class=o>=</span><span class=s2>&#34;-systemd -gnome -gnome-keyring -bindist&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>USE_OTHER</span><span class=o>=</span><span class=s2>&#34;python lua&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>USE</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>USE_YES</span><span class=si>}</span><span class=s2> </span><span class=si>${</span><span class=nv>USE_NO</span><span class=si>}</span><span class=s2> </span><span class=si>${</span><span class=nv>USE_OTHER</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>########## Portage And Emerge Config ##########</span>
</span></span><span class=line><span class=cl><span class=nv>PORTAGE_DIR</span><span class=o>=</span><span class=s2>&#34;/var/portage&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>DISTDIR</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>PORTAGE_DIR</span><span class=si>}</span><span class=s2>/dist&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>PKGDIR</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>PORTAGE_DIR</span><span class=si>}</span><span class=s2>/pkgs&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>GENTOO_MIRRORS</span><span class=o>=</span><span class=s2>&#34;https://mirrors.tuna.tsinghua.edu.cn/gentoo/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>EMERGE_DEFAULT_OPTS</span><span class=o>=</span><span class=s2>&#34;--ask --verbose=y --keep-going --with-bdeps=y&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>ACCEPT_KEYWORDS</span><span class=o>=</span><span class=s2>&#34;~amd64&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>ACCEPT_LICENSE</span><span class=o>=</span><span class=s2>&#34;*&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>########## Other Config ##########</span>
</span></span><span class=line><span class=cl><span class=c1># Language</span>
</span></span><span class=line><span class=cl><span class=nv>L10N</span><span class=o>=</span><span class=s2>&#34;en-US zh-CN en zh&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>LINGUAS</span><span class=o>=</span><span class=s2>&#34;en_US zh_CN en zh&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Video Cards</span>
</span></span><span class=line><span class=cl><span class=nv>VIDEO_CARDS</span><span class=o>=</span><span class=s2>&#34;intel nvidia radeon vesa&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Grub Platform</span>
</span></span><span class=line><span class=cl><span class=nv>GRUB_PLATFORMS</span><span class=o>=</span><span class=s2>&#34;efi-64&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ...</span>
</span></span></code></pre></td></tr></table></div></div></div><h2 id=进入gentoo环境><a href=#进入gentoo环境 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:进入gentoo环境 class=headings>进入Gentoo环境</a></h2><p>复制DNS信息：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp --dereference /etc/resolv.conf /mnt/gentoo/etc/
</span></span></code></pre></td></tr></table></div></div></div><p>挂载必要的文件系统：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mount --types proc /proc /mnt/gentoo/proc
</span></span><span class=line><span class=cl>mount --rbind /sys /mnt/gentoo/sys
</span></span><span class=line><span class=cl>mount --make-rslave /mnt/gentoo/sys
</span></span><span class=line><span class=cl>mount --rbind /dev /mnt/gentoo/dev
</span></span><span class=line><span class=cl>mount --make-rslave /mnt/gentoo/dev
</span></span><span class=line><span class=cl>mount --bind /run /mnt/gentoo/run
</span></span><span class=line><span class=cl>mount --make-slave /mnt/gentoo/run
</span></span></code></pre></td></tr></table></div></div></div><p>如果使用非Gentoo安装介质，可能需要额外操作：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>test</span> -L /dev/shm <span class=o>&amp;&amp;</span> rm /dev/shm <span class=o>&amp;&amp;</span> mkdir /dev/shm
</span></span><span class=line><span class=cl>mount --types tmpfs --options nosuid,nodev,noexec shm /dev/shm
</span></span><span class=line><span class=cl>chmod <span class=m>1777</span> /dev/shm /run/shm
</span></span></code></pre></td></tr></table></div></div></div><p>chroot进入Gentoo环境：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Arch安装介质使用</span>
</span></span><span class=line><span class=cl><span class=c1># arch-chroot /mnt/gentoo</span>
</span></span><span class=line><span class=cl><span class=c1># 官方安装介质使用</span>
</span></span><span class=line><span class=cl>chroot /mnt/gentoo /bin/bash
</span></span><span class=line><span class=cl><span class=c1># 加载环境变量</span>
</span></span><span class=line><span class=cl><span class=nb>source</span> /etc/profile
</span></span><span class=line><span class=cl><span class=c1># 设置提示符，区分环境</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PS1</span><span class=o>=</span><span class=s2>&#34;(chroot) </span><span class=si>${</span><span class=nv>PS1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div></div><p>现在开始所有操作都是在Gentoo环境下进行！</p><p>挂载Boot和Home分区（如果有）：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mount /dev/sda1 /boot
</span></span><span class=line><span class=cl>mount /dev/sda2 /home
</span></span></code></pre></td></tr></table></div></div></div><p>参考链接：</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Base/zh-cn#.E5.A4.8D.E5.88.B6DNS.E4.BF.A1.E6.81.AF target=_blank rel=noopener>Gentoo Wiki</a></li></ul><h2 id=配置-portage-并更新系统><a href=#配置-portage-并更新系统 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:配置-portage-并更新系统 class=headings>配置 Portage 并更新系统</a></h2><p>先使用镜像快照更新数据库(通常为24小时内快照)：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>emerge-webrsync
</span></span></code></pre></td></tr></table></div></div></div><p>进一步更新到一小时内最新数据库：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>emerge --sync
</span></span><span class=line><span class=cl><span class=c1># 也可以使用</span>
</span></span><span class=line><span class=cl>emerge --sync --quiet
</span></span></code></pre></td></tr></table></div></div></div><p>更新完数据库后，可能会发布一些最新通知，建议查看，以查看某些大的更改：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>eselect news list
</span></span><span class=line><span class=cl>eselect news <span class=nb>read</span>
</span></span></code></pre></td></tr></table></div></div></div><p>选择配置文件，不同配置文件包含了不同的软件包及其依赖，更换配置文件后USE标记也会更新，之后需要对整个系统进行更新来应用更改，比如某些软件更改，依赖该软件的其他软件可能需要重新编译。</p><p>列出所有配置并选择：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 列出</span>
</span></span><span class=line><span class=cl>eselect profile list
</span></span><span class=line><span class=cl><span class=c1># 选择</span>
</span></span><span class=line><span class=cl>eselect profile <span class=nb>set</span> &lt;序号&gt;
</span></span></code></pre></td></tr></table></div></div></div><p>更换配置文件或者更改USE标记后，使用下面命令进行系统更新，之后就是漫长的编译安装过程，期间可以玩几把游戏或者看剧 -_- ：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>emerge --ask --verbose --update --deep --newuse @world
</span></span></code></pre></td></tr></table></div></div></div><p>期间如果遇到循环依赖等情况，那就自求多福，查看Wiki如何解决吧，刚开始USE不要写太多，这样可以避免一些问题，不过随着USE越来越多，很难避免这些情况。</p><p>跑完之后，再检查一遍是否更新完成：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>emerge @preserved-rebuild
</span></span><span class=line><span class=cl>perl-cleaner --all
</span></span><span class=line><span class=cl>emerge -auvDN --with-bdeps<span class=o>=</span>y @world
</span></span></code></pre></td></tr></table></div></div></div><p>参考链接：</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Base/zh-cn#.E9.85.8D.E7.BD.AE_Portage target=_blank rel=noopener>Gentoo Wiki</a></li></ul><h2 id=配置时区与区域><a href=#配置时区与区域 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:配置时区与区域 class=headings>配置时区与区域</a></h2><p>国内下面这样设置即可：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 时区上海，其他时区使用 ls /usr/share/zoneinfo 查看</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Asia/Shanghai&#34;</span> &gt; /etc/timezone
</span></span><span class=line><span class=cl><span class=c1># openrc使用</span>
</span></span><span class=line><span class=cl>emerge --config sys-libs/timezone-data
</span></span><span class=line><span class=cl><span class=c1># systemd使用</span>
</span></span><span class=line><span class=cl>ln -sf ../usr/share/zoneinfo/Europe/Brussels /etc/localtime
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nano /etc/locale.gen
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl>en_US.UTF-8 UTF-8
</span></span><span class=line><span class=cl>zh_CN.UTF-8 UTF-8
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 生成指定地区</span>
</span></span><span class=line><span class=cl>locale-gen
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看可用区域</span>
</span></span><span class=line><span class=cl>eselect locale list
</span></span><span class=line><span class=cl><span class=c1># 选择，建议英文，X换为上面序号</span>
</span></span><span class=line><span class=cl>eselect locale <span class=nb>set</span> X
</span></span></code></pre></td></tr></table></div></div></div><p>参考链接：</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Base/zh-cn#.E9.85.8D.E7.BD.AE.E5.8C.BA.E5.9F.9F.E8.AE.BE.E7.BD.AE target=_blank rel=noopener>Gentoo Wiki</a></li></ul><h2 id=配置文件系统><a href=#配置文件系统 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:配置文件系统 class=headings>配置文件系统</a></h2><p>fstab配置，UUID可以使用 <code>blkid</code> 查看 :</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nano /etc/fstab
</span></span><span class=line><span class=cl>----------------------
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>xxxxxxxxxxx   /boot    vfat           defaults    <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>xxxxxxxxxxx   /        ext4或btrfs等   defaults    <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>xxxxxxxxxxx   /home    ext4或btrfs等   defaults    <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>xxxxxxxxxxx   none     swap           defaults    <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>----------------------
</span></span></code></pre></td></tr></table></div></div></div><p>如果使用 btrfs 文件系统，需要提前安装 <code>emerge sys-fs/btrfs-progs</code> 。</p><p>参考链接：</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Base/zh-cn#.E9.85.8D.E7.BD.AE.E5.8C.BA.E5.9F.9F.E8.AE.BE.E7.BD.AE target=_blank rel=noopener>Gentoo Wiki</a></li></ul><h2 id=其他配置><a href=#其他配置 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:其他配置 class=headings>其他配置</a></h2><h3 id=修改主机名><a href=#修改主机名 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:修改主机名 class=headings>修改主机名：</a></h3><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Gentoo 主机名文件位置跟其他Linux发行版有所区别</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>hostname</span><span class=o>=</span><span class=se>\&#34;</span>Gentoo<span class=se>\&#34;</span> &gt; /etc/conf.d/hostname
</span></span></code></pre></td></tr></table></div></div></div><h3 id=配置网络><a href=#配置网络 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:配置网络 class=headings>配置网络：</a></h3><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># NetworkManager 方便连接 Wifi</span>
</span></span><span class=line><span class=cl>emerge -av networkmanager net-misc/dhcpcd net-wireless/wpa_supplicant
</span></span><span class=line><span class=cl><span class=c1># 设置开机自启动</span>
</span></span><span class=line><span class=cl>rc-update add NetworkManager default
</span></span><span class=line><span class=cl>rc-update add dhcpcd default
</span></span><span class=line><span class=cl><span class=c1># systemd</span>
</span></span><span class=line><span class=cl><span class=c1># systemctl enable NetworkManager</span>
</span></span><span class=line><span class=cl><span class=c1># systemctl enable dhcpcd</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 编辑 /etc/hosts 文件，设置本机IP</span>
</span></span><span class=line><span class=cl>nano /etc/hosts
</span></span><span class=line><span class=cl>-----------------
</span></span><span class=line><span class=cl>127.0.0.1 localhost
</span></span><span class=line><span class=cl>::1 localhost
</span></span><span class=line><span class=cl>127.0.0.1 &lt;上面设置的主机名&gt;.localdomain &lt;主机名&gt;
</span></span><span class=line><span class=cl>-----------------
</span></span></code></pre></td></tr></table></div></div></div><h3 id=安装内核><a href=#安装内核 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:安装内核 class=headings>安装内核</a></h3><p>自己配置内核很麻烦，所以建议在安装阶段先使用 Gentoo 官方内核，等开机后有时间再自己去配置优化自己的内核。</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 安装固件</span>
</span></span><span class=line><span class=cl>emerge -av sys-kernel/linux-firmware
</span></span><span class=line><span class=cl><span class=c1># 安装内核源码</span>
</span></span><span class=line><span class=cl>emerge -av sys-kernel/gentoo-sources
</span></span><span class=line><span class=cl><span class=c1># 安装内核配置工具</span>
</span></span><span class=line><span class=cl>emerge -av sys-kernel/genkernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 编译安装内核</span>
</span></span><span class=line><span class=cl>genkernel --menuconfig all
</span></span><span class=line><span class=cl>genkernel --install initramfs
</span></span></code></pre></td></tr></table></div></div></div><h3 id=安装必要的软件><a href=#安装必要的软件 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:安装必要的软件 class=headings>安装必要的软件</a></h3><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 安装日志工具 (openrc)</span>
</span></span><span class=line><span class=cl>emerge -av sysklogd
</span></span><span class=line><span class=cl>rc-update add sysklogd default
</span></span><span class=line><span class=cl><span class=c1># cron守护进程</span>
</span></span><span class=line><span class=cl>emerge -av sys-process/cronie
</span></span><span class=line><span class=cl>rc-update add cronie default
</span></span><span class=line><span class=cl><span class=c1># shell补全</span>
</span></span><span class=line><span class=cl>emerge -av app-shells/bash-completion
</span></span><span class=line><span class=cl><span class=c1># 时间同步</span>
</span></span><span class=line><span class=cl>emerge --ask net-misc/chrony
</span></span><span class=line><span class=cl>rc-update add chronyd default
</span></span><span class=line><span class=cl><span class=c1># systemd</span>
</span></span><span class=line><span class=cl><span class=c1># systemctl enable chronyd.service</span>
</span></span><span class=line><span class=cl><span class=c1># 安装sudo</span>
</span></span><span class=line><span class=cl>emerge -av sudo
</span></span><span class=line><span class=cl><span class=c1># 安装vim、git</span>
</span></span><span class=line><span class=cl>emerge -av vim git
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 配置root权限</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/\# \%wheel ALL=(ALL) ALL/\%wheel ALL=(ALL) ALL/g&#39;</span> /etc/sudoers
</span></span><span class=line><span class=cl><span class=c1># 重置root密码</span>
</span></span><span class=line><span class=cl>passwd
</span></span></code></pre></td></tr></table></div></div></div><h3 id=配置引导><a href=#配置引导 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:配置引导 class=headings>配置引导：</a></h3><p>安装 Grub 前检查 <code>/etc/portage/make.conf</code> 文件是否设置了 <strong>GRUB_PLATFORMS="efi-64"</strong> ，没有则需要添加：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;GRUB_PLATFORMS=&#34;efi-64&#34;&#39;</span> &gt;&gt; /etc/portage/make.conf
</span></span></code></pre></td></tr></table></div></div></div><p>安装 Grub 并配置：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>emerge -av sys-boot/grub
</span></span><span class=line><span class=cl><span class=c1># 将grub安装到/boot/grub，如果双系统已经安装过grub，则先删除/boot/grub目录</span>
</span></span><span class=line><span class=cl>grub-install --target<span class=o>=</span>x86_64-efi --efi-directory<span class=o>=</span>/boot --bootloader-id<span class=o>=</span>Gentoo
</span></span><span class=line><span class=cl><span class=c1># 生成配置文件</span>
</span></span><span class=line><span class=cl>grub-mkconfig -o /boot/grub/grub.cfg
</span></span></code></pre></td></tr></table></div></div></div><h3 id=添加用户><a href=#添加用户 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:添加用户 class=headings>添加用户</a></h3><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 添加一个管理员账户</span>
</span></span><span class=line><span class=cl>useradd -m -G users,wheel,portage,usb,video &lt;你的用户名<span class=o>(</span>小写<span class=o>)</span>&gt;
</span></span><span class=line><span class=cl><span class=c1># 修改密码</span>
</span></span><span class=line><span class=cl>passwd &lt;用户名&gt;
</span></span></code></pre></td></tr></table></div></div></div><p>参考链接：</p><ul><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/System/zh-cn target=_blank rel=noopener>Gentoo Wiki - 0</a></li><li><a href=https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Tools/zh-cn target=_blank rel=noopener>Gentoo Wiki - 1</a></li></ul><h2 id=收尾工作><a href=#收尾工作 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:收尾工作 class=headings>收尾工作</a></h2><p>最后再检查一遍下面的配置是否正确：</p><ul><li>/boot目录下是否有内核即Grub文件</li><li>/etc/fstab 文件挂载目录是否正确</li><li>用户及root权限、密码</li><li>必要的工具比如网络配置软件</li></ul><p>确定无误后重启进入系统：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 退出 chroot 环境</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl><span class=c1># 取消挂载</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span>
</span></span><span class=line><span class=cl>umount -l /mnt/gentoo/dev<span class=o>{</span>/shm,/pts,<span class=o>}</span>
</span></span><span class=line><span class=cl>umount -R /mnt/gentoo
</span></span><span class=line><span class=cl><span class=c1># 重启，黑屏后拔出U盘</span>
</span></span><span class=line><span class=cl>reboot
</span></span></code></pre></td></tr></table></div></div></div><h2 id=最后><a href=#最后 class=anchor-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon anchor-icon"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96.0-59.27-59.26-59.27-155.7.0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757.0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037.0 01-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482.0 0120.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96.0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454.0 0020.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037.0 00-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639.0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg></a><a href=#contents:最后 class=headings>最后</a></h2><p>如果系统成功启动，那么恭喜你完成了难度很高的 Gentoo 安装工作，但是对于使用 Gentoo 来说，
安装只是第一步，接下来就需要你自己完成剩余的装修工作了，难度丝毫不亚于安装的难度，但是你也会收获很多。
比如 Linux 内核配置优化流程、各种软件 USE 标记使用、循环依赖怎么解决、桌面环境选择等等。</p></div><ul class=post-copyright><li class="copyright-item author"><span class=copyright-item-text>作者</span>：<a href=https://blog.ticks.cc class="p-author h-card" target=_blank rel=noopener>Ticks</a></li><li class="copyright-item link"><span class=copyright-item-text>链接</span>：<a href=/posts/id/09061821/ target=_blank rel=noopener>https://blog.ticks.cc/posts/id/09061821/</a></li><li class="copyright-item license"><span class=copyright-item-text>许可</span>：<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>CC BY-NC-SA 4.0</a></li></ul></article><div class=updated-badge-container><span title="Updated @ 2024-02-06 05:46:33 UTC" style=cursor:help><svg xmlns="http://www.w3.org/2000/svg" width="130" height="20" class="updated-badge"><linearGradient id="b" x2="0" y2="100%"><stop offset="0" stop-color="#bbb" stop-opacity=".1"/><stop offset="1" stop-opacity=".1"/></linearGradient><clipPath id="a"><rect width="130" height="20" rx="3" fill="#fff"/></clipPath><g clip-path="url(#a)"><path class="updated-badge-left" d="M0 0h55v20H0z"/><path class="updated-badge-right" d="M55 0h75v20H55z"/><path fill="url(#b)" d="M0 0h130v20H0z"/></g><g fill="#fff" text-anchor="middle" font-size="110"><text x="285" y="150" fill="#010101" fill-opacity=".3" textLength="450" transform="scale(.1)">updated</text><text x="285" y="140" textLength="450" transform="scale(.1)">updated</text><text x="915" y="150" fill="#010101" fill-opacity=".3" textLength="650" transform="scale(.1)">2024-02-06</text><text x="915" y="140" textLength="650" transform="scale(.1)">2024-02-06</text></g></svg></span></div><div class=post-share><div class=share-items><div class="share-item twitter"><a href="https://twitter.com/share?url=https://blog.ticks.cc/posts/id/09061821/&amp;text=Gentoo%e5%ae%89%e8%a3%85%e8%ae%b0%e5%bd%95&amp;hashtags=Linux,%e6%97%a5%e5%b8%b8,%e6%8a%98%e8%85%be,&amp;via=ticks07" title=分享到「Twitter」 target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon twitter-icon"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></a></div><div class="share-item telegram"><a href="https://t.me/share/url?url=https://blog.ticks.cc/posts/id/09061821/&amp;text=Gentoo%e5%ae%89%e8%a3%85%e8%ae%b0%e5%bd%95" title=分享到「Telegram」 target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="icon telegram-icon"><path d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm121.8 169.9-40.7 191.8c-3 13.6-11.1 16.9-22.4 10.5l-62-45.7-29.9 28.8c-3.3 3.3-6.1 6.1-12.5 6.1l4.4-63.1 114.9-103.8c5-4.4-1.1-6.9-7.7-2.5l-142 89.4-61.2-19.1c-13.3-4.2-13.6-13.3 2.8-19.7l239.1-92.2c11.1-4 20.8 2.7 17.2 19.5z"/></svg></a></div><div class="share-item qq"><a href="https://connect.qq.com/widget/shareqq/index.html?url=https://blog.ticks.cc/posts/id/09061821/&amp;title=Gentoo%e5%ae%89%e8%a3%85%e8%ae%b0%e5%bd%95&amp;summary=%e6%9c%80%e8%bf%91%e6%89%93%e7%ae%97%e5%b0%86%e6%89%8b%e4%b8%8a%e7%9a%84%20AMD%20Linux%20%e5%88%87%e6%8d%a2%e5%88%b0%20Gentoo%ef%bc%8c%e5%86%99%e4%b8%80%e7%af%87%e6%96%87%e7%ab%a0%e8%ae%b0%e5%bd%95%e4%b8%8b%e5%ae%89%e8%a3%85%e8%bf%87%e7%a8%8b%e3%80%82%20%e6%9c%ac%e6%96%87%e5%8f%af%e8%83%bd%e4%b8%8d%e9%80%82%e7%94%a8%e4%ba%8eL%e2%80%a6%e2%80%a6&amp;pics=https://blog.ticks.cc/icons/apple-touch-icon.png&amp;site=Ticks%e7%9a%84%e5%8d%9a%e5%ae%a2" title=分享到「QQ」 target=_blank rel=noopener><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon qq-icon"><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741.0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792.0.0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"/></svg></a></div></div></div><div class=related-posts><h2 class=related-title>相关文章：<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6.0-12-5.4-12-12v-92h-92c-6.6.0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6.0 12 5.4 12 12v92h92c6.6.0 12 5.4 12 12v56z"/></svg></h2><ul class=related-list><li class=related-item><a href=/posts/id/37hugsk/ class=related-link>Arch Linux下Hyprland配置</a></li><li class=related-item><a href=/posts/id/ef0vy/ class=related-link>红米K40内核KernelSU编译</a></li><li class=related-item><a href=/posts/id/26gstgj/ class=related-link>Gnome美化教程</a></li></ul></div><div class=post-tags><a href=/tags/linux/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>Linux</a>
<a href=/tags/%E6%97%A5%E5%B8%B8/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>日常</a>
<a href=/tags/%E6%8A%98%E8%85%BE/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>折腾</a></div><ul class=post-nav><li class=post-nav-prev><a href=/posts/id/11041720/ rel=prev>&lt; C++协程01 协程概述</a></li><li class=post-nav-next><a href=/posts/id/6131519/ rel=next>Git rebase使用 ></a></li></ul></div></main><div id=back-to-top class=back-to-top><a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a></div><footer id=footer class=footer><div class=footer-inner><div class=site-info>©&nbsp;2023–2024&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3.0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;Ticks</div><div class=powered-by>Powered by <a href=https://github.com/gohugoio/hugo target=_blank rel=noopener>Hugo</a> | Theme is <a href=https://github.com/reuixiy/hugo-theme-meme target=_blank rel=noopener>MemE</a></div></div></footer></div><script>"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js")})</script><script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script><script>let imgNodes=document.querySelectorAll("div.post-body img");imgNodes=Array.from(imgNodes).filter(e=>e.parentNode.tagName!=="A"),mediumZoom(imgNodes,{background:"hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)"})</script><script src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js type=module defer></script></body></html>